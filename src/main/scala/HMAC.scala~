import net.liftweb.util.SecurityHelpers.hash256

object HMAC {
  val opad = 0x5c
  val ipad = 0x36

  def apply(k: Array[Byte], msg: Array[Byte]) {
    // HMAC(K,m) = H((K xor opad) + H((K xor ipad) + m))

    val blkSize = 64 // SHA256 block size
    val key = k.padTo(blkSize, 0x00.toByte) // either truncate or pad k to blkSize

    // val opad = Array.fill[Byte](blkSize)(0x5c.toByte)
    // val ipad = Array.fill[Byte](blkSize)(0x36.toByte)

    val oKeyPad = key.map(k => (k ^ 0x5c).toByte)
    val iKeyPad = key.map(k => (k ^ 0x36).toByte)

    hash256(oKeyPad ++ hash256(iKeyPad 
  }

}






